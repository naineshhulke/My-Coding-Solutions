#define ll long long
#include <bits/stdc++.h>
using namespace std;

int main() {
	ll t,n,k,x;
	cin>>t;
	while(t--){
	    cin>>n>>k;
	    vector <ll> a;
	    for(ll i=0;i<n;i++){
	        cin>>x;
	        a.push_back(x);
	    }
	    sort(a.begin(), a.end());
	    if(n==1){
	        cout<<a[0]<<endl;
	        
	    }
	    else{
	        ll p=0,ans=0,i;
	        for(i=0;i<n-2;i++){
	            if(a[i]<=k){
	                ans+=a[i];
	                continue;
	            }
	            else{
	                 p+=a[i]-k;
	                 a[i]=k;
	                 ans+=k;
	            }
	        }
	        if(a[n-2]<=k){
	            ans+=a[n-2];
	            ans+=a[n-1];
	        }
	        else{
	            
	        ll q=a[n-2]-k;
	        if(q>p){
	            a[n-1]-=q-p;
	        }
	        else{
	            a[n-1]-=((p-q)%2);
	        }
	        ans+=k;
	        ans+=a[n-1];
	        }
	        
	        cout<<ans<<endl;
	        
	    }
	}
	return 0;
	
}
